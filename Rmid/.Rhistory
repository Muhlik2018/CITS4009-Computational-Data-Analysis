library("dplyr")
library("ggplot2")
df1<-read.csv("df1.csv")
df2<-read.csv("df2.csv")
df1 %>%
inner_join(df2, by = "product")
df1 %>%
semi_join(df2, by = "product")
df1 %>%
anti_join(df2, by = "product")
df1 %>%
full_join(df2, by = "product")
df2<-read.csv("df2.csv")
df1<-read.csv("df1.csv")
out<-aggregate(df1[,"persons"],FUN=sum,by=df1$suburb)
out<-aggregate(df1[,"persons"],FUN=sum,by=df1$suburb))
out<-aggregate(df1[,"persons"],FUN=sum,by=list(df1$suburb))
df2<-read.csv("df2.csv")
df2$population.density<-out$x/land.area
df2$population.density<-out$x/df2$land.area
out<-df1%>%subset(select="persons")%>%aggregate(sum,by=list(df1$suburb))
df2<-read.csv("df2.csv")
df2<-within(df2,{population.desity<-out$persons/land.area})
data<-read.csv("sort_speed.csv")
ggplot(data, aes(ArraySize, TimeUsed, color = IsParallel)) + geom_line(aes(linetype = Algorithm), size=1) + geom_point(aes(shape=Algorithm), size=3)
library("dplyr")
library("ggplot2")
ggplot(data, aes(ArraySize, TimeUsed, color = IsParallel)) + geom_line(aes(linetype = Algorithm), size=1) + geom_point(aes(shape=Algorithm), size=3)
data<-read.csv("sort_speed.csv")
ggplot(data, aes(ArraySize, TimeUsed, color = IsParallel)) + geom_line(aes(linetype = Algorithm), size=1) + geom_point(aes(shape=Algorithm), size=3)
temp<-filter(data, Algorithm=="enum")
ggplot(temp, aes(ArraySize, TimeUsed, color = IsParallel)) + geom_line(aes(linetype = Algorithm), size=1) + geom_point(aes(shape=Algorithm), size=3)
temp<-filter(data, Algorithm=="ENUM")
ggplot(temp, aes(ArraySize, TimeUsed, color = IsParallel)) + geom_line(aes(linetype = Algorithm), size=1) + geom_point(aes(shape=Algorithm), size=3)
data<-read.csv("sort_speed.csv")
temp<-filter(data, Algorithm=="ENUM")
ggplot(temp, aes(ArraySize, TimeUsed, color = IsParallel)) + geom_line(aes(linetype = Algorithm), size=1) + geom_point(aes(shape=Algorithm), size=3)
View(data)
data<-read.csv("sort_speed.csv")
temp<-filter(data, Algorithm=="ENUM")
ggplot(temp, aes(ArraySize, TimeUsed, color = IsParallel)) + geom_line(aes(linetype = Algorithm), size=1) + geom_point(aes(shape=Algorithm), size=3)
temp<-filter(data, Algorithm=="QUICK")
ggplot(temp, aes(ArraySize, TimeUsed, color = IsParallel)) + geom_line(aes(linetype = Algorithm), size=1) + geom_point(aes(shape=Algorithm), size=3)
temp<-filter(data, Algorithm=="MERGE")
ggplot(temp, aes(ArraySize, TimeUsed, color = IsParallel)) + geom_line(aes(linetype = Algorithm), size=1) + geom_point(aes(shape=Algorithm), size=3)
qchisq(0.95,1)
qchisq(0.05,52)
30.8/qchisq(0.05,52)
15.4/qchisq(0.05,52)
30.8/qchisq(0.95,52)
1840*2/qchisq(0.01,50)
1840*2/qchisq(0.49,50)
30.8/qchisq(0.95,54)
30.8/qchisq(0.05,54)
30.8/qchisq(0.95,54)
15.4*3/qchisq(0.95,54)
30.8*2/qchisq(0.95,52)
30.8*2/qchisq(0.95,54)
30.8*2/qchisq(0.05,54)
30.8/qchisq(0.05,54)
30.8/qchisq(0.95,54)
qchisq(0.95,1)
30.8/qchisq(0.95,1)
30.8/qchisq(0.95,56)
30.8/qchisq(0.95,52)
30.8/qchisq(0.95,50)
12.8*2/qchisq(0.05,40)
1840/14
1840*2/qchisq(0.01,48)
1840*2/qchisq(0.01,50)
1840*2/qchisq(0.49,50)
1840*2/qchisq(0.49,48)
1740*2/qchisq(0.01,40)
1840*2/qchisq(0.99,48)
1840*2/qchisq(0.99,50)
1740*2/qchisq(0.01,40)
1740*2/qchisq(0.99,40)
15.4*2/qchisq(0.05,52)
15.4*2/qchisq(0.95,52)
15.4*2/qchisq(0.95,50)
1740*2/qchisq(0.99,40)
1740*2/qchisq(0.99,40)
1740*2/qchisq(0.99,42)
1740*2/qchisq(0.99,38)
1740*2/qchisq(0.95,38)
1740*2/qchisq(0.95,40)
1840*2/qchisq(0.95,40)
1840*2/qchisq(0.95,50)
1840*2/qchisq(0.05,50)
?pt
dt(2.01,21)
dt(1.94,21)
?dnorm
dnorm(-1.87)
?pchisq
pchisq
?rt
?pnorm
pnorm(2.4,0,1)
pnorm(15.7,14,5)
pnorm(15.7,14,sqrt(5))
pnorm(15,14,sqrt(5))
0.95-pnorm(15,14,sqrt(5))
pnorm(-1.86,0,1)
?pt
pt(-1.86,199)
2*pt(-1.86,199)
2*pnorm(-1.86,0,1)
2*pnorm(-1.87,0,1)
178.2*2/9
148.2*2/9
qchisq
?qchisq
qchisq(148.2*2/9,20)
pchisq(148.2*2/9,20)
pchisq(148.2*2/9,20)-1
pchisq(98.2*2/9,30)-1
library("dplyr")
library("ggplot2")
data<-read.csv("df1.csv")
View(data)
View(data)
data<-mutate(data,
{if(persons>3)level=1;
else level=0})
data<-mutate(data,
{if(persons>3)level=1;})
library("ggplot2")
data<-read.csv("flights.csv")
summary(data)
data <- data[,-c(25,32)]
data <- data[,-c(25,32)]
data <- data[,-c(22,29)]
data<-read.csv("df1.csv")
data<-read.csv("flights.csv")
data<-data[,-c(25:31)]
data$DEPARTURE_DELAY[data$DEPARTURE_DELAY>0]<-1
data$DEPARTURE_DELAY[data$DEPARTURE_DELAY<=0]<-0
data$ARRIVAL_DELAY[data$ARRIVAL_DELAY>0]<-1
data$ARRIVAL_DELAY[data$ARRIVAL_DELAY<=0]<-0
data<-na.omit(data)
data2<-sample(nrow(data),0.1*nrow(data))
data2<-data[data2,]
data2$DISTANCE_LEVEL[data2$DISTANCE<3000]<-"Short"
data2$DISTANCE_LEVEL[data2$DISTANCE>=3000]<-"Long"
data3<-data2
data2<-data2[,grepl("ARRIVAL_DELAY|DEPARTURE_DELAY|AIR_TIME|DISTANCE", colnames(data))]
data.kmeans<-kmeans(data2,2)
table(data3$DISTANCE_LEVEL,data.kmeans$cluster)
data2<-data2[,grepl("ARRIVAL_DELAY|DISTANCE", colnames(data))]
data2<-data2[,grepl("ARRIVAL_DELAY|DISTANCE", colnames(data))]
data2<-sample(nrow(data),0.1*nrow(data))
data2<-data[data2,]
data2$DISTANCE_LEVEL[data2$DISTANCE<3000]<-"Short"
data2$DISTANCE_LEVEL[data2$DISTANCE>=3000]<-"Long"
data3<-data2
data2<-data2[,grepl("ARRIVAL_DELAY|DISTANCE", colnames(data))]
data.kmeans<-kmeans(data2,2)
table(data3$DISTANCE_LEVEL,data.kmeans$cluster)
plot(data2$DISTANCE,data2$ARRIVAL_DELAY,col=data.kmeans$cluster,pch="*")
rm(list=ls())
data<-read.csv("flights.csv")
data2<-sample(nrow(data),0.1*nrow(data))
data2<-data[data2,]
data<-data[,-c(25:31)] #delete useless line
data<-na.omit(data)
data2<-sample(nrow(data),0.1*nrow(data))
data2<-data[data2,]
data2$DISTANCE_LEVEL[data2$DISTANCE<2000]<-"Short"
data2$DISTANCE_LEVEL[data2$DISTANCE>=2000&data2$DISTANCE<4000]<-"Mid"
data2$DISTANCE_LEVEL[data2$DISTANCE>=4000]<-"Long"
data2$DISTANCE_LEVEL[data2$DISTANCE<2000]<-"Short"
data2$DISTANCE_LEVEL[data2$DISTANCE>=2000&data2$DISTANCE<4000]<-"Mid"
data2$DISTANCE_LEVEL[data2$DISTANCE>=4000]<-"Long"
data3<-data2
data2<-data2[,grepl("ARRIVAL_DELAY|DISTANCE", colnames(data))]
data.kmeans<-kmeans(data2,3)
table(data3$DISTANCE_LEVEL,data.kmeans$cluster)
plot(data2$DISTANCE,data2$ARRIVAL_DELAY,col=data.kmeans$cluster,pch="*")
points(data.kmeans$centers,pch="X",cex=1.5,col=4)
km.res = kmeans(data2, 3, nstart = 25)
fviz_cluster(km.res, data3)
install.packages("cluster")
library(cluster)
data.pam<-kmeans(data2,3)
table(data3$DISTANCE_LEVEL,data.pam$clustering)
View(data2)
table(iris$Species,data.kmeans$clustering)
table(data3$DISTANCE_LEVEL.kmeans$clustering)
table(data3$DISTANCE_LEVEL,data.kmeans$cluster)
table(data3$DISTANCE_LEVEL,data.pam$clustering)
data.pam<-kmeans(data2,3)
data.pam<-kmeans(data2,3)
table(data3$DISTANCE_LEVEL,data.pam$clustering)
data.pam<-pam(data2,3)
data.pam<-pam(data3,3)
data.clara<-clara(data2,3)
table(data3$DISTANCE_LEVEL,data.clara$clustering)
install.packages("fpc")
library(fpc)
data.pamk<-pamk(data2,3)
dim(data)
idx<-sample(1:dim(data)[1],40)
data4<-data[idx,-5]
View(data4)
data4<-data3[,grepl("ARRIVAL_DELAY|DISTANCE|DISTANCE_LEVEL", colnames(data3))]
data4<-data[-5]
data4<-data3[,grepl("ARRIVAL_DELAY|DISTANCE|DISTANCE_LEVEL", colnames(data3))]
data4<-data4[-5]
data4<-data4[-2]
ds<-dbscan(data2,eps=0.42,MinPts = 5)
table(ds$cluster,data3$DISTANCE_LEVEL)
ds<-dbscan(data2,eps=1,MinPts = 500)
data4<-sample(nrow(data3),0.01*nrow(data3))
data4<-data[data4,]
data5<-data4
data5<-data5[,grepl("ARRIVAL_DELAY|DISTANCE", colnames(data5))]
ds<-dbscan(data5,eps=0.42,MinPts = 5)
table(ds$cluster,data4$DISTANCE_LEVEL)
table(ds$cluster,data4$DISTANCE_LEVEL)
data4$DISTANCE_LEVEL[data3$DISTANCE<2000]<-"Short"
data4$DISTANCE_LEVEL[data4$DISTANCE<2000]<-"Short"
data4$DISTANCE_LEVEL[data4$DISTANCE>=2000&data2$DISTANCE<4000]<-"Mid"
data4$DISTANCE_LEVEL[data4$DISTANCE>=2000&data4$DISTANCE<4000]<-"Mid"
data4$DISTANCE_LEVEL[data4$DISTANCE>=4000]<-"Long"
table(ds$cluster,data4$DISTANCE_LEVEL)
plotcluster(data5,ds$cluster)
ds<-dbscan(iris2,eps=0.42,MinPts = 2)
ds<-dbscan(data4,eps=0.42,MinPts = 2)
ds<-dbscan(data5,eps=0.42,MinPts = 2)
table(ds$cluster,data4$DISTANCE_LEVEL)
ds<-dbscan(data5,eps=1,MinPts = 5)
table(ds$cluster,data4$DISTANCE_LEVEL)
ds<-dbscan(data5,eps=1,MinPts = 10)
table(ds$cluster,data4$DISTANCE_LEVEL)
ds<-dbscan(data5,eps=1,MinPts = 8)
table(ds$cluster,data4$DISTANCE_LEVEL)
ds<-dbscan(data5,eps=1,MinPts = 6)
table(ds$cluster,data4$DISTANCE_LEVEL)
ds<-dbscan(data5,eps=1,MinPts = 7)
table(ds$cluster,data4$DISTANCE_LEVEL)
plotcluster(data5,ds$cluster)
View(data5)
data4$DISTANCE_LEVEL[data4$DISTANCE<3000]<-"Short"
data4$DISTANCE_LEVEL[data4$DISTANCE>=3000]<-"Long"
data5<-data4
data5<-data5[,grepl("ARRIVAL_DELAY|DISTANCE", colnames(data5))]
View(data5)
data5<-data5[,grepl("ARRIVAL_DELAY|DISTANCE", colnames(data5))]
data5<-data5[-3]
ds<-dbscan(data5,eps=0.42,MinPts = 5)
table(ds$cluster,data4$DISTANCE_LEVEL)
ds<-dbscan(data5,eps=0.1,MinPts = 5)
table(ds$cluster,data4$DISTANCE_LEVEL)
ds<-dbscan(data5,eps=0.4,MinPts = 50)
table(ds$cluster,data4$DISTANCE_LEVEL)
ds<-dbscan(data5,eps=1,MinPts = 50)
table(ds$cluster,data4$DISTANCE_LEVEL)
ds<-dbscan(data5,eps=1,MinPts = 6)
table(ds$cluster,data4$DISTANCE_LEVEL)
ds<-dbscan(data5,eps=1,MinPts = 7)
table(ds$cluster,data4$DISTANCE_LEVEL)
ds<-dbscan(data5,eps=0.1,MinPts = 7)
table(ds$cluster,data4$DISTANCE_LEVEL)
ds<-dbscan(data5,eps=2,MinPts = 7)
table(ds$cluster,data4$DISTANCE_LEVEL)
ds<-dbscan(data5,eps=2,MinPts = 10)
table(ds$cluster,data4$DISTANCE_LEVEL)
knitr::opts_chunk$set(echo = TRUE)
rmarkdown::render('new.Rmd', 'html_notebook')
rmarkdown::render('new.Rmd', 'html_notebook')
knitr::opts_chunk$set(echo = TRUE)
library(cluster)
library("dplyr")
library("ggplot2")
data<-read.csv("flights.csv")
data<-data[,-c(25:31)] #delete useless line
data<-na.omit(data)
summary(data)
rmarkdown::render('new.Rmd', 'html_notebook')
knitr::opts_chunk$set(echo = TRUE)
library(cluster)
library("dplyr")
library("ggplot2")
data<-read.csv("flights.csv")
data<-data[,-c(25:31)] #delete useless line
data<-na.omit(data)
head(data)
data$IS_DELAY[data$DEPARTURE_DELAY>0|ARRIVAL_DELAY>0]<-1
View(data)
data$IS_DELAY[data$DEPARTURE_DELAY>0|ARRIVAL_DELAY>0]<-1
data$IS_DELAY[data$DEPARTURE_DELAY>0|data$ARRIVAL_DELAY>0]<-1
data$IS_DELAY[data$DEPARTURE_DELAY<=0&data$ARRIVAL_DELAY<=0]<-0
data$IS_DELAY[data$DEPARTURE_DELAY>0|data$ARRIVAL_DELAY>0]<-1
data$IS_DELAY[data$DEPARTURE_DELAY<=0&data$ARRIVAL_DELAY<=0]<-0
head(data)
data2<-sample(nrow(data),0.1*nrow(data))
data2<-data[data2,]
data3<-data2
data2<-data3[,grepl("IS_DELAY|DISTANCE", colnames(data3))]
data3$DISTANCE_LEVEL[data3$DISTANCE<2000]<-"Short"
data3$DISTANCE_LEVEL[data3$DISTANCE>=2000&data3$DISTANCE<4000]<-"Mid"
data3$DISTANCE_LEVEL[data3$DISTANCE>=4000]<-"Long"
data2<-sample(nrow(data),0.1*nrow(data))
data2<-data[data2,]
data3<-data2
data2<-data3[,grepl("IS_DELAY|DISTANCE", colnames(data3))]
data3$DISTANCE_LEVEL[data3$DISTANCE<2000]<-"Short"
data3$DISTANCE_LEVEL[data3$DISTANCE>=2000&data3$DISTANCE<4000]<-"Mid"
data3$DISTANCE_LEVEL[data3$DISTANCE>=4000]<-"Long"
head(data2)
head(data3)
data.kmeans<-kmeans(data2,3)
table(data3$DISTANCE_LEVEL,data.kmeans$cluster)
data2<-data2[,grepl("ARRIVAL_DELAY|DISTANCE", colnames(data))]
data2<-data2[,grepl("ARRIVAL_DELAY|DISTANCE", colnames(data3))]
data2<-data3[,grepl("ARRIVAL_DELAY|DISTANCE", colnames(data))]
plot(data2$DISTANCE,data2$DEPARTURE_DELAY,pch="*")
data2<-data3[,grepl("ARRIVAL_DELAY|DISTANCE", colnames(data))]
plot(data2$DISTANCE,data2$ARRIVAL_DELAY,pch="*")
data.kmeans<-kmeans(data2,3)
table(data3$DISTANCE_LEVEL,data.kmeans$cluster)
data.kmeans<-kmeans(data2,3)
table(data3$DISTANCE_LEVEL,data.kmeans$cluster)
plot(data2$DISTANCE,data2$ARRIVAL_DELAY,col=data.kmeans$cluster,pch="*")
points(data.kmeans$centers,pch="X",cex=1.5,col=4)
data3$DISTANCE_LEVEL[data3$DISTANCE<3000]<-"Short"
data3$DISTANCE_LEVEL[data3$DISTANCE>=3000]<-"Long"
table(data3$DISTANCE_LEVEL,data.kmeans$cluster)
plot(data2$DISTANCE,data2$ARRIVAL_DELAY,col=data.kmeans$cluster,pch="*")
points(data.kmeans$centers,pch="X",cex=1.5,col=4)
data.clara<-clara(data2,3)
data.kmeans<-kmeans(data2,2)
table(data3$DISTANCE_LEVEL,data.kmeans$cluster)
plot(data2$DISTANCE,data2$ARRIVAL_DELAY,col=data.kmeans$cluster,pch="*")
points(data.kmeans$centers,pch="X",cex=1.5,col=4)
data3$DISTANCE_LEVEL[data3$DISTANCE<3000]<-"Short"
data3$DISTANCE_LEVEL[data3$DISTANCE>=3000]<-"Long"
table(data3$DISTANCE_LEVEL,data.kmeans$cluster)
plot(data2$DISTANCE,data2$ARRIVAL_DELAY,col=data.kmeans$cluster,pch="*")
points(data.kmeans$centers,pch="X",cex=1.5,col=4)
data.clara<-clara(data2,3)
table(data3$DISTANCE_LEVEL,data.pam$clustering)
data.clara<-clara(data2,3)
table(data3$DISTANCE_LEVEL,data.clara$clustering)
layout(matrix(c(1,2),1,2))
plot(data.clara)
layout(matrix(1))
data.clara<-clara(data2,2)
table(data3$DISTANCE_LEVEL,data.clara$clustering)
layout(matrix(c(1,2),1,2))
plot(data.clara)
layout(matrix(1))
data4<-sample(nrow(data3),0.01*nrow(data3))
data4<-data[data4,]
data4$DISTANCE_LEVEL[data4$DISTANCE<3000]<-"Short"
data4$DISTANCE_LEVEL[data4$DISTANCE>=3000]<-"Long"
data5<-data4
data5<-data5[,grepl("ARRIVAL_DELAY|DISTANCE", colnames(data5))]
ds<-dbscan(data5,eps=1,MinPts = 7)
library(cluster)
library("dplyr")
library("ggplot2")
library(fpc)
data4<-sample(nrow(data3),0.01*nrow(data3))
data4<-data[data4,]
data4$DISTANCE_LEVEL[data4$DISTANCE<3000]<-"Short"
data4$DISTANCE_LEVEL[data4$DISTANCE>=3000]<-"Long"
data5<-data4
data5<-data5[,grepl("ARRIVAL_DELAY|DISTANCE", colnames(data5))]
ds<-dbscan(data5,eps=1,MinPts = 7)
data4<-sample(nrow(data3),0.01*nrow(data3))
data4<-data[data4,]
data4$DISTANCE_LEVEL[data4$DISTANCE<3000]<-"Short"
data4$DISTANCE_LEVEL[data4$DISTANCE>=3000]<-"Long"
data5<-data4
data5<-data5[,grepl("ARRIVAL_DELAY|DISTANCE", colnames(data5))]
ds<-dbscan(data5,eps=0.42,MinPts =5)
data4<-sample(nrow(data3),0.01*nrow(data3))
data4<-data[data4,]
data4$DISTANCE_LEVEL[data4$DISTANCE<3000]<-"Short"
data4$DISTANCE_LEVEL[data4$DISTANCE>=3000]<-"Long"
data5<-data4
data5<-data5[,grepl("ARRIVAL_DELAY|DISTANCE", colnames(data5))]
ds<-dbscan(data5,eps=0.42,MinPts = 5)
View(data5)
data4<-sample(nrow(data3),0.01*nrow(data3))
data4<-data[data4,]
data4$DISTANCE_LEVEL[data4$DISTANCE<3000]<-"Short"
data4$DISTANCE_LEVEL[data4$DISTANCE>=3000]<-"Long"
data5<-data4
data5<-data5[,grepl("ARRIVAL_DELAY|DISTANCE", colnames(data5))]
data5[-3]
ds<-dbscan(data5,eps=0.42,MinPts = 5)
View(data5)
data4<-sample(nrow(data3),0.01*nrow(data3))
data4<-data[data4,]
data4$DISTANCE_LEVEL[data4$DISTANCE<3000]<-"Short"
data4$DISTANCE_LEVEL[data4$DISTANCE>=3000]<-"Long"
data5<-data4
data5<-data5[,grepl("ARRIVAL_DELAY|DISTANCE", colnames(data5))]
data5[c(-3)]
ds<-dbscan(data5,eps=0.42,MinPts = 5)
data4<-sample(nrow(data3),0.01*nrow(data3))
data4<-data[data4,]
data4$DISTANCE_LEVEL[data4$DISTANCE<3000]<-"Short"
data4$DISTANCE_LEVEL[data4$DISTANCE>=3000]<-"Long"
data5<-data4
data5<-data5[,grepl("ARRIVAL_DELAY|DISTANCE", colnames(data5))]
data5[,-3]
ds<-dbscan(data5,eps=0.42,MinPts = 5)
data4<-sample(nrow(data3),0.01*nrow(data3))
data4<-data[data4,]
data4$DISTANCE_LEVEL[data4$DISTANCE<3000]<-"Short"
data4$DISTANCE_LEVEL[data4$DISTANCE>=3000]<-"Long"
data5<-data4
data5<-data5[,grepl("ARRIVAL_DELAY|DISTANCE", colnames(data5))]
data5[,-2]
ds<-dbscan(data5,eps=0.42,MinPts = 5)
data4<-sample(nrow(data3),0.01*nrow(data3))
data4<-data[data4,]
data4$DISTANCE_LEVEL[data4$DISTANCE<3000]<-"Short"
data4$DISTANCE_LEVEL[data4$DISTANCE>=3000]<-"Long"
data5<-data4
data5<-data5[,grepl("ARRIVAL_DELAY|DISTANCE", colnames(data5))]
data5<-data5[,-3]
ds<-dbscan(data5,eps=0.42,MinPts = 5)
table(ds$cluster,data4$DISTANCE_LEVEL)
plot(ds,data5)
plotcluster(data5,ds$cluster)
rmarkdown::render('new.Rmd', 'html_notebook')
